{{ config(
    indexes = [{'columns':['_airbyte_emitted_at'],'type':'btree'}],
    unique_key = '_airbyte_ab_id',
    schema = "_airbyte_public",
    tags = [ "top-level-intermediate" ]
) }}
-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
-- depends_on: {{ ref('date_convertor_ab1') }}
select
    cast(_id as {{ dbt_utils.type_string() }}) as _id,
    cast(cq3 as {{ dbt_utils.type_float() }}) as cq3,
    cast(cq7 as {{ dbt_utils.type_float() }}) as cq7,
    cast(cq8 as {{ dbt_utils.type_float() }}) as cq8,
    cast(cq9 as {{ dbt_utils.type_float() }}) as cq9,
    cast(cq10 as {{ dbt_utils.type_float() }}) as cq10,
    cast(cq16 as {{ dbt_utils.type_float() }}) as cq16,
    cast(cq4t as {{ dbt_utils.type_string() }}) as cq4t,
    cast(cq10a as {{ dbt_utils.type_string() }}) as cq10a,
    cast(cq10b as {{ dbt_utils.type_string() }}) as cq10b,
    cast(cq13b as {{ dbt_utils.type_string() }}) as cq13b,
    cast(queue as {{ dbt_utils.type_string() }}) as queue,
    cast(region as {{ dbt_utils.type_string() }}) as region,
    cast(status as {{ dbt_utils.type_string() }}) as status,
    cast(severity as {{ dbt_utils.type_string() }}) as severity,
    cast(bug_cases as {{ dbt_utils.type_string() }}) as bug_cases,
    cast(case_type as {{ dbt_utils.type_string() }}) as case_type,
    cast(defect_id as {{ dbt_utils.type_string() }}) as defect_id,
    cast(asset_name as {{ dbt_utils.type_string() }}) as asset_name,
    cast(case_owner as {{ dbt_utils.type_string() }}) as case_owner,
    cast(openeddate as {{ dbt_utils.type_string() }}) as openeddate,
    cast(case_number as {{ dbt_utils.type_float() }}) as case_number,
    cast(case_origin as {{ dbt_utils.type_string() }}) as case_origin,
    cast(account_name as {{ dbt_utils.type_string() }}) as account_name,
    cast(federal_case as {{ dbt_utils.type_string() }}) as federal_case,
    cast(product_line as {{ dbt_utils.type_string() }}) as product_line,
    cast(case_category as {{ dbt_utils.type_string() }}) as case_category,
    cast(customer_type as {{ dbt_utils.type_string() }}) as customer_type,
    cast(handover_type as {{ dbt_utils.type_string() }}) as handover_type,
    cast(loyalty_index as {{ dbt_utils.type_float() }}) as loyalty_index,
    cast(product_group as {{ dbt_utils.type_string() }}) as product_group,
    cast(exclusion_flag as {{ dbt_utils.type_string() }}) as exclusion_flag,
    cast(previous_owner as {{ dbt_utils.type_string() }}) as previous_owner,
    cast(product_number as {{ dbt_utils.type_string() }}) as product_number,
    cast(requestor_lang as {{ dbt_utils.type_string() }}) as requestor_lang,
    cast(escalation_date as {{ dbt_utils.type_string() }}) as escalation_date,
    cast(customer_domain as {{ dbt_utils.type_string() }}) as customer_domain,
    cast(customer_ref_id as {{ dbt_utils.type_string() }}) as customer_ref_id,
    cast(detailed_status as {{ dbt_utils.type_string() }}) as detailed_status,
    cast(escalation_date_1 as {{ dbt_utils.type_string() }}) as escalation_date_1,
    cast(escalation_flag as {{ dbt_utils.type_string() }}) as escalation_flag,
    cast(resolution_code as {{ dbt_utils.type_string() }}) as resolution_code,
    cast(resolution_date as {{ dbt_utils.type_string() }}) as resolution_date,
    cast(case_subcategory as {{ dbt_utils.type_string() }}) as case_subcategory,
    cast(date_time_closed as {{ dbt_utils.type_string() }}) as date_time_closed,
    cast(date_time_opened as {{ dbt_utils.type_string() }}) as date_time_opened,
    cast(entitlement_type as {{ dbt_utils.type_string() }}) as entitlement_type,
    cast(escalation_tier1 as {{ dbt_utils.type_string() }}) as escalation_tier1,
    cast(escalation_tier2 as {{ dbt_utils.type_string() }}) as escalation_tier2,
    cast(escalation_tier3 as {{ dbt_utils.type_string() }}) as escalation_tier3,
    cast(escalation_tier4 as {{ dbt_utils.type_string() }}) as escalation_tier4,
    cast(highest_severity as {{ dbt_utils.type_string() }}) as highest_severity,
    cast(physical_country as {{ dbt_utils.type_string() }}) as physical_country,
    cast(product_category as {{ dbt_utils.type_string() }}) as product_category,
    cast(software_version as {{ dbt_utils.type_string() }}) as software_version,
    cast(availability_flag as {{ dbt_utils.type_string() }}) as availability_flag,
    cast(account_page_level as {{ dbt_utils.type_string() }}) as account_page_level,
    cast(case_contact_email as {{ dbt_utils.type_string() }}) as case_contact_email,
    cast(case_owner_manager as {{ dbt_utils.type_string() }}) as case_owner_manager,
    cast(overall_experience as {{ dbt_utils.type_float() }}) as overall_experience,
    cast(parent_case_number as {{ dbt_utils.type_string() }}) as parent_case_number,
    cast(resolution_subcode as {{ dbt_utils.type_string() }}) as resolution_subcode,
    cast(entitlement_summary as {{ dbt_utils.type_string() }}) as entitlement_summary,
    cast(part_arrived_ontime as {{ dbt_utils.type_float() }}) as part_arrived_ontime,
    cast(survey_received_date as {{ dbt_utils.type_string() }}) as survey_received_date,
    cast(esc_addressed_datetime as {{ dbt_utils.type_string() }}) as esc_addressed_datetime,
    cast(closeddate_aibyte_transform as {{ dbt_utils.type_string() }}) as closeddate_aibyte_transform,
    cast(resolution_provided_satisfactory as {{ dbt_utils.type_float() }}) as resolution_provided_satisfactory,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    {{ current_timestamp() }} as _airbyte_normalized_at
from {{ ref('date_convertor_ab1') }}
-- date_convertor
where 1 = 1

